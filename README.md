# dtn-onion-routing
This project aims to define a method to perform onion routing over a well-known network, such as in public transports, using NS-3. Concretely this project can be divided in two subprojects **NS-3 simulations** and **Path selection**:

##NS-3 simulations##

This section is divided as follows: First we explain briefly which mobility traces we have. Next, we explain how the scenario has been implemented and finally we explain the output data generated by the execution of this scenario.

##### Mobility traces ######
We have two NS-2 mobility traces that can be used with this project: uab-busses and seattle-busses. Both of them are in simulations/data/mobility_traces folder and are called as uab-busses.ns_movements and tue-11-27-traces.ns_movements respectively. In addition, as the uab-busses mobility traces have been generated by the SUMO tool, the SUMO project files are included in simulations/data/sumo/uab-scenario.

The uab-busses traces are composed by 5 busses (or nodes) that follows mainly the [UAB official schedule](https://www.uab.cat/web/by-bus/the-uab-internal-bus-service-1273127179834.html). Regarding the Seattle busses traces were obtained from [1]. These traces were obtained monitoring with a GPS each bus movement for 1 month (approximately). As this traces are too big to upload them here, they can be obtained (upon registration) [here](http://crawdad.org/rice/ad_hoc_city).

##### Implementation ######
The NS-3 implementation can be found in simulations folder. Concretely, we have three folders. The first one (data) is devoted to get the inputs and outputs of the simulation. The scratch folder is the scenario itself and inside the src directory we can found differend used implementations as neighbor discovery, graph managment and the modified mobility helper to obtain different needed data.

The scratch/bus-topology.cc file is the one that we run using NS-3, it has two parts: the first one is a class named SimulationUtils aimed simply in managing simulation times in a visual way, i.e: show a percentage of the simulation done periodically. The second part is the one in charge of import the mobility model, create the nodes, install the ad-hoc wifi, etc.

We developed some different applications and structures useful for our research like a neighbor discovery application and a graph structure.

As NS-3 does not have a DTN module, so we created a NeighBour discovery applications that sends a broadcast message periodically to know which nodes are availeable to communicate with. At the same time, this information is saved in a Graph structure.

##### Output data ######
Once the Graph structure has been completed, we print this information into a file in simulations/data/graphs/ with the following structure:

The structure of the exported graphs is as follows:

nodeId neighborId contactTime duration

nodeId: 	identifier of the source node.
neighborId: 	identifier of the neighbor that has contacted with nodeId.
contactTime:	The time in seconds when te contact occurred.
duration:	The time in seconds of the duration of the contact between nodeId and neighborId.
##Path selection##


It is important to note that the relevant parts of this project are explained deeply and can be used by the SeNDA department in [DevLab Platform Simulation](http://senda.uab.cat/wiki/DevLab_Platform_Simulation).

## References ##
[1] - Jorjeta G. Jetcheva, Yih-Chun Hu, Santashil PalChaudhuri, Amit Kumar Saha, and David B. Johnson. Design and Evaluation of a Metropolitan Area Multitier Wireless Ad Hoc Network Architecture. Proceedings of the 5th IEEE Workshop on Mobile Computing Systems & Applications (WMCSA 2003), IEEE, Monterey, CA, October 2003. 
